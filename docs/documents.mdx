The Documents service provides applications with the ability to store and retrieve application state.
Nitric strives to make this process as easy as possible, using a documents API. Application code can specify
the name of the collection and use a set of powerful methods to query and manage the documents.

Nitric will automatically provision any required infrastructure with your cloud provider.

## Key concepts

### Documents

Documents are the unit of storage within a collection. They are a lightweight record that contains fields, which map to values. Each document is identified by a unique id.

A document representing an actor `downeyjr` might look like this:

```json
üìÑ downeyjr
{
  "first": "Robert",
  "last": "Downey Jr",
  "born": 1965
}
```

TODO talk about data types and nested documents briefly

### Collections

Collections are simply containers for documents. In SQL database terms a collections equate to tables.

For example, you could have an actors collection to contain various actors, each represented by a document:

```json
üóÇÔ∏è actors
    üìÑ downeyjr
    {
     "first": "Robert",
     "last": "Downey Jr",
     "born": 1965
    }
    üìÑ johansson
    {
     "first": "Scarlett",
     "last": "Johansson",
     "born": 1984
    }
```

The ids of documents within a collection are unique. You also do not need to create or delete collections as this is automatically handled when a document is created or all documents in a collection are deleted.

### References

References are a uniquely identifiable location within a database. A reference can be created regardless of whether data exists and does not perform any network calls. You can create document and collection references.

<CodeExamples 
	languages={[
	{
		label: "Node.js",
		value: "node"
	},
	{
		label: "Python",
		value: "python"
	},
	{
		label: "Java",
		value: "java"
	},
	{
		label: "Go",
		value: "go"
	},
	{
		label: "PHP",
		value: "php"
	},
	{
		label: "C#",
		value: "c-sharp"
	}
	]}
	defaultLang="node"
>
<CodeExample lang="node">

```typescript
// create a reference to a collection named 'products'
const collection = documents().collection('products');

// create a reference to a document named 'nitric'
const nitric = collection.doc('nitric');
```

</CodeExample>
<CodeExample lang="python">

```python
# create a reference to a collection named 'products'
products = documents.collection("products")

# create a reference to a document named 'nitric'
nitric = products.doc("nitric")
```

</CodeExample>

<CodeExample lang="java">

```java
TODO
```

</CodeExample>

<CodeExample lang="go">

```go
import (
	"github.com/nitrictech/go-sdk/api/documents"
)

...

docs, _ := documents.New()

// Create a reference to a new collection named 'products'
products := docs.Collection("products")

// Create a reference to a new documenbt named 'nitric'
nitric := products.Doc("nitric")
```

</CodeExample>

<CodeExample lang="php">

```php
// Todo
```

</CodeExample>

<CodeExample lang="c-sharp">

```csharp
TODO
```

</CodeExample>

</CodeExamples>

## Usage

Using one of the provided Nitric SDKs for your language is the easiest way to work with collections.

## Add and manage data

To add a new document to a collection, use the `set()` method with an explicitly specifying a document identifier:

### Set a document

<CodeExamples 
	languages={[
	{
		label: "Node.js",
		value: "node"
	},
	{
		label: "Python",
		value: "python"
	},
	{
		label: "Java",
		value: "java"
	},
	{
		label: "Go",
		value: "go"
	},
	{
		label: "PHP",
		value: "php"
	},
	{
		label: "C#",
		value: "c-sharp"
	}
	]}
	defaultLang="node"
>
<CodeExample lang="node">

```typescript
import { documents } from '@nitric/sdk';

interface Product {
  id: string;
  name: string;
  description: string;
}

const collection = documents().collection<Product>('products');

await collection.doc('nitric').set({
  id: 'nitric',
  name: 'nitric',
  description: 'A development framework!',
});
```

</CodeExample>
<CodeExample lang="python">

```python
from nitric.api import Documents

# construct a documents client with default options
documents = Documents()

# create a reference to a collection named 'products'
products = documents.collection("products")

# create/update a document with the id 'nitric', in the products collection
await products.doc("nitric").set({
    "id": "nitric",
    "name": "Nitric Framework",
    "description": "A development framework",
})
```

</CodeExample>

<CodeExample lang="java">

```java
import io.nitric.api.kv.KeyValueClient;
...

var client = KeyValueClient.newBuilder(Product.class)
	.collection("products")
	.build();

var product = new Product();

client.put("nitric", product);
```

</CodeExample>

<CodeExample lang="go">

```go
import (
	"github.com/nitrictech/go-sdk/api/documents"
)

...

docs, _ := documents.New()

// Create a reference to a new collection named 'products'
products := docs.Collection("products")

// Create a reference to a new documenbt named 'nitric'
nitric := products.Doc("nitric")

err := nitric.Set(map[string]inteface{}{
	"id": "nitric",
	"name": "Nitric Framework",
	"description": "A development framework",
})

if err != nil {
	// handle error
}
```

</CodeExample>

<CodeExample lang="php">

```php
// Todo
```

</CodeExample>

<CodeExample lang="c-sharp">

```csharp
using Nitric.Api.KeyValue;
...

var client = new KeyValueClient<Product>.NewBuilder()
	.Collection("products")
	.Build();

var product = new Product();

client.Put("nitric", product);
```

</CodeExample>

</CodeExamples>

### Update a document

> Check back soon! We are working on it ‚ö†Ô∏è

### Delete documents

To delete a document from a collection, use the `delete()` method.
When you delete a document, the Nitric API will automatically delete all documents within its subcollections.

<CodeExamples 
	languages={[
	{
		label: "Node.js",
		value: "node"
	},
	{
		label: "Python",
		value: "python"
	},
	{
		label: "Java",
		value: "java"
	},
	{
		label: "Go",
		value: "go"
	},
	{
		label: "PHP",
		value: "php"
	},
	{
		label: "C#",
		value: "c-sharp"
	}
	]}
	defaultLang="node"
>
<CodeExample lang="node">

```typescript
import { documents } from '@nitric/sdk';

await documents().collection('products').doc('nitric').delete();
```

</CodeExample>
<CodeExample lang="python">

```python
from nitric.api import Documents

documents = Documents()

await documents.collection("products").doc("nitric").delete()
```

</CodeExample>

<CodeExample lang="java">

```java
import io.nitric.api.kv.KeyValueClient;
...

var client = KeyValueClient.newBuilder(Product.class)
	.collection("products")
	.build();

client.delete("nitric");
```

</CodeExample>

<CodeExample lang="go">

```go
import (
	"github.com/nitrictech/go-sdk/api/documents"
)

...

docs, _ := documents.New()

// Create a reference to a new collection named 'products'
products := docs.Collection("products")

// Create a reference to a new documenbt named 'nitric'
nitric := products.Doc("nitric")

err := nitric.Delete()

if err != nil {
	// handle error
}
```

</CodeExample>

<CodeExample lang="php">

```php
use Nitric\Api\KeyValueClient;

$client = new KeyValueClient();

$client->delete("nitric");
```

</CodeExample>

<CodeExample lang="c-sharp">

```csharp
using Nitric.Api.KeyValue;
...

var client =  new KeyValueClient<Product>.NewBuilder()
	.Collection("products")
	.Build();

client.Delete("nitric");
```

</CodeExample>

</CodeExamples>

## Read data

There are three ways to retrieve data, any of these methods can be used with documents, collections of documents, or the results of queries:

- Call the `get()` method to retrieve a single document.

- Call the `fetch()` or `stream()` methods to retrieve multiple documents.

### Get data once

The following example shows how to retrieve the contents of a single document using `get()`:

<CodeExamples 
	languages={[
	{
		label: "Node.js",
		value: "node"
	},
	{
		label: "Python",
		value: "python"
	},
	{
		label: "Java",
		value: "java"
	},
	{
		label: "Go",
		value: "go"
	},
	{
		label: "PHP",
		value: "php"
	},
	{
		label: "C#",
		value: "c-sharp"
	}
	]}
	defaultLang="node"
>
<CodeExample lang="node">

```typescript
import { documents } from '@nitric/sdk';

const client = documents();

const product = await client.collection('products').doc('nitric').get();
```

</CodeExample>
<CodeExample lang="python">

```python
from nitric.api import Documents

documents = Documents()

product = await documents.collection("products").doc("nitric").get()

product.content["name"] = "new nitric"
```

</CodeExample>

<CodeExample lang="java">

```java
import io.nitric.api.kv.KeyValueClient;
...

var client = KeyValueClient.newBuilder(Product.class)
	.collection("products")
	.build();

var product = client.get("nitric");
```

</CodeExample>

<CodeExample lang="go">

```go
import (
    "github.com/nitrictech/go-sdk/api"
    "github.com/nitrictech/go-sdk/kvclient"
)

kvClient := client.KV()

product, err := kvclient.get("products", "nitric")

if err != nil {
	// Handle error
}
```

</CodeExample>

<CodeExample lang="php">

```php
use Nitric\Api\KeyValueClient;

$client = new KeyValueClient();

$product = $client->get("products", "nitric");
```

</CodeExample>

<CodeExample lang="c-sharp">

```csharp
using Nitric.Api.KeyValue;
...

var client =  new KeyValueClient<Product>.NewBuilder()
	.Collection("products")
	.Build();

var product = client.Get("nitric")
```

</CodeExample>

</CodeExamples>

### Queries

The documents API provides powerful query functionality for specifying which documents you want to retrieve from a collection.
This queries can be executed with the `fetch()` and `stream()` methods.

#### Simple queries

The following query returns all customers who are 21 years old or older:

<CodeExamples 
	languages={[
	{
		label: "Node.js",
		value: "node"
	},
	{
		label: "Python",
		value: "python"
	},
	{
		label: "Java",
		value: "java"
	},
	{
		label: "Go",
		value: "go"
	},
	{
		label: "PHP",
		value: "php"
	},
	{
		label: "C#",
		value: "c-sharp"
	}
	]}
	defaultLang="node"
>
<CodeExample lang="node">

```typescript
import { documents } from '@nitric/sdk';

const client = documents();

const query = await client
  .collection('customers')
  .query()
  .where('age', '>=', 21);

// Execute query
const documents = await query.fetch();
```

</CodeExample>
<CodeExample lang="python">

```python
TODO
```

</CodeExample>

<CodeExample lang="java">

```java
TODO
```

</CodeExample>

<CodeExample lang="go">

```go
import (
	"github.com/nitrictech/go-sdk/api/documents"
)

...

docs, _ := documents.New()

// Create a reference to a new collection named 'products'
query := docs.Collection("customers").Query().Where(
	Condition("age").Gt("21")
)

// Create a reference to a new documenbt named 'nitric'
result, err := query.Fetch()
```

</CodeExample>

<CodeExample lang="php">

```php
TODO
```

</CodeExample>

<CodeExample lang="c-sharp">

```csharp
TODO
```

</CodeExample>

</CodeExamples>

#### Compound queries

You can chain multiple equality operator methods to create specific queries.

<CodeExamples 
	languages={[
	{
		label: "Node.js",
		value: "node"
	},
	{
		label: "Python",
		value: "python"
	},
	{
		label: "Java",
		value: "java"
	},
	{
		label: "Go",
		value: "go"
	},
	{
		label: "PHP",
		value: "php"
	},
	{
		label: "C#",
		value: "c-sharp"
	}
	]}
	defaultLang="node"
>
<CodeExample lang="node">

```typescript
import { documents } from '@nitric/sdk';

const client = documents();

const query = await client
  .collection('customers')
  .query()
  .where('country', '==', 'Australia');
  .where('age', '>=', 21);

// Execute query
const documents = await query.fetch();
```

</CodeExample>
<CodeExample lang="python">

```python
TODO
```

</CodeExample>

<CodeExample lang="java">

```java
TODO
```

</CodeExample>

<CodeExample lang="go">

```go
import (
	"github.com/nitrictech/go-sdk/api/documents"
)

...

docs, _ := documents.New()

// Create a reference to a new collection named 'products'
query := docs.Collection("customers").Query().Where(
	Condition("country").Eq("Australia")
	Condition("age").Gt("21")
)

// Create a reference to a new documenbt named 'nitric'
result, err := query.Fetch()
```

</CodeExample>

<CodeExample lang="php">

```php
TODO
```

</CodeExample>

<CodeExample lang="c-sharp">

```csharp
TODO
```

</CodeExample>

</CodeExamples>

### Query operators

To query documents, the `where()` method can be used. It takes three parameters: a field to filter on, a comparison operator, and a value.

The document service supports the following comparison operators:

- `<` less than

- `<=` less than or equal to

- `==` equal to

- `>` greater than

- `>=` greater than or equal to

- `!=` not equal to

### Limit data

By default all documents that are returned by the query are retrieved. You can limit the number of documents retrieved using the `limit()` method:

<CodeExamples 
	languages={[
	{
		label: "Node.js",
		value: "node"
	},
	{
		label: "Python",
		value: "python"
	},
	{
		label: "Java",
		value: "java"
	},
	{
		label: "Go",
		value: "go"
	},
	{
		label: "PHP",
		value: "php"
	},
	{
		label: "C#",
		value: "c-sharp"
	}
	]}
	defaultLang="node"
>
<CodeExample lang="node">

```typescript
import { documents } from '@nitric/sdk';

const client = documents();

const query = await client.collection('customers').query().limit(10);

// Get up to 10 customers
const documents = await query.fetch();
```

</CodeExample>
<CodeExample lang="python">

```python
TODO
```

</CodeExample>

<CodeExample lang="java">

```java
TODO
```

</CodeExample>

<CodeExample lang="go">

```go
import (
	"github.com/nitrictech/go-sdk/api/documents"
)

...

docs, _ := documents.New()

// Create a reference to a new collection named 'products'
query := docs.Collection("customers").Query().Limit(10)

// Create a reference to a new documenbt named 'nitric'
result, err := query.Fetch()
```

</CodeExample>

<CodeExample lang="php">

```php
TODO
```

</CodeExample>

<CodeExample lang="c-sharp">

```csharp
TODO
```

</CodeExample>

</CodeExamples>

### Paginate data

> Check back soon! We are working on it ‚ö†Ô∏è

### Stream data

> Check back soon! We are working on it ‚ö†Ô∏è
