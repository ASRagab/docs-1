The Documents service provides applications with the ability to store and retrieve application state.
Nitric strives to make this process as easy as possible, using a documents API. Application code can specify
the name of the collection and use a set of powerful methods to query and manage the documents.

Nitric will automatically provision any required infrastructure with your cloud provider.

## Key concepts

### Documents

Documents are the unit of storage within a collection. They are a lightweight record that contains fields, which map to values. Each document is identified by a unique id.

A document representing an actor `downeyjr` might look like this:

```json
üìÑ downeyjr
{
  "first": "Robert",
  "last": "Downey Jr",
  "born": 1965
}
```

You can nest complex objects like arrays or maps within documents. However if your data expands over time, a much more scalable solution would be to create Subcollections within documents.

### Collections

Collections are simply containers for documents. In SQL database terms a collection equates to a table.

For example, you could have an actors collection to contain various actors, each represented by a document:

```json
üóÇÔ∏è actors
    üìÑ downeyjr
    {
     "first": "Robert",
     "last": "Downey Jr",
     "born": 1965
    }
    üìÑ johansson
    {
     "first": "Scarlett",
     "last": "Johansson",
     "born": 1984
    }
```

#### Subcollections

Subcollections allow you to structure data hierarchically, making data easier to access. This is perfect when you have data that expands over time.

The advantages of Subcollections are that the parent collection size doesn't change when your Subcollections grow and you also get full query capabilities.

### References

References are a uniquely identifiable location within a database. A reference can be created regardless of whether data exists and does not perform any network calls. You can create document and collection references.

<CodeExamples 
	languages={[
	{
		label: "Node.js",
		value: "node"
	},
	{
		label: "Python",
		value: "python"
	},
	{
		label: "Java",
		value: "java"
	},
	{
		label: "Go",
		value: "go"
	},
	{
		label: "PHP",
		value: "php"
	},
	{
		label: "C#",
		value: "c-sharp"
	}
	]}
	defaultLang="node"
>
<CodeExample lang="node">

```typescript
// create a reference to a collection named 'products'
const collection = documents().collection('products');

// create a reference to a document named 'nitric'
const nitric = collection.doc('nitric');
```

</CodeExample>
<CodeExample lang="python">

```python
# create a reference to a collection named 'products'
products = documents.collection("products")

# create a reference to a document named 'nitric'
nitric = products.doc("nitric")
```

</CodeExample>

<CodeExample lang="java">

```java
TODO
```

</CodeExample>

<CodeExample lang="go">

```go
import (
	"github.com/nitrictech/go-sdk/api/documents"
)

...

docs, _ := documents.New()

// Create a reference to a new collection named 'products'
products := docs.Collection("products")

// Create a reference to a new document named 'nitric'
nitric := products.Doc("nitric")
```

</CodeExample>

<CodeExample lang="php">

```php
use Nitric\Api\Documents;

$docs = new Documents();

// Create a reference to a new collection named 'products'
$products = $docs->collection("products")

// Create a reference to a new document named 'nitric'
$docRef = $products->doc("nitric");
```

</CodeExample>

<CodeExample lang="c-sharp">

```csharp
TODO
```

</CodeExample>

</CodeExamples>

## Usage

Using one of the provided Nitric SDKs for your language is the easiest way to work with collections.

## Add and manage data

To add a new document to a collection, use the `set()` method on a document reference:

### Set a document

<CodeExamples 
	languages={[
	{
		label: "Node.js",
		value: "node"
	},
	{
		label: "Python",
		value: "python"
	},
	{
		label: "Java",
		value: "java"
	},
	{
		label: "Go",
		value: "go"
	},
	{
		label: "PHP",
		value: "php"
	},
	{
		label: "C#",
		value: "c-sharp"
	}
	]}
	defaultLang="node"
>
<CodeExample lang="node">

```typescript
import { documents } from '@nitric/sdk';

interface Product {
  id: string;
  name: string;
  description: string;
}

const collection = documents().collection<Product>('products');

await collection.doc('nitric').set({
  id: 'nitric',
  name: 'nitric',
  description: 'A development framework!',
});
```

</CodeExample>
<CodeExample lang="python">

```python
from nitric.api import Documents

# construct a documents client with default options
documents = Documents()

# create a reference to a collection named 'products'
products = documents.collection("products")

# create/update a document with the id 'nitric', in the products collection
await products.doc("nitric").set({
    "id": "nitric",
    "name": "Nitric Framework",
    "description": "A development framework",
})
```

</CodeExample>
<CodeExample lang="java">

```java
import io.nitric.api.kv.KeyValueClient;
...

var client = KeyValueClient.newBuilder(Product.class)
	.collection("products")
	.build();

var product = new Product();

client.put("nitric", product);
```

</CodeExample>
<CodeExample lang="go">

```go
import (
	"github.com/nitrictech/go-sdk/api/documents"
)

...

docs, _ := documents.New()

// Create a reference to a new collection named 'products'
products := docs.Collection("products")

// Create a reference to a new document named 'nitric'
nitric := products.Doc("nitric")

err := nitric.Set(map[string]inteface{}{
	"id": "nitric",
	"name": "Nitric Framework",
	"description": "A development framework",
})

if err != nil {
	// handle error
}
```

</CodeExample>
<CodeExample lang="php">

```php
use Nitric\Api\Documents;

$docs = new Documents();

// Create a reference to a new collection named 'products'
$products = $docs->collection("products")

// Create a reference to a new document named 'nitric'
$docRef = $products->doc("nitric");

$docRef->set([
    "id" => "nitric",
    "name" => "Nitric Framework",
    "description" => "A development framework",
]);
```

</CodeExample>
<CodeExample lang="c-sharp">

```csharp
using Nitric.Api.KeyValue;
...

var client = new KeyValueClient<Product>.NewBuilder()
	.Collection("products")
	.Build();

var product = new Product();

client.Put("nitric", product);
```

</CodeExample>
</CodeExamples>

### Delete documents

To delete a document from a collection, use the `delete()` method.
When you delete a document, the Nitric API will automatically delete all documents within its subcollections.

<CodeExamples 
	languages={[
	{
		label: "Node.js",
		value: "node"
	},
	{
		label: "Python",
		value: "python"
	},
	{
		label: "Java",
		value: "java"
	},
	{
		label: "Go",
		value: "go"
	},
	{
		label: "PHP",
		value: "php"
	},
	{
		label: "C#",
		value: "c-sharp"
	}
	]}
	defaultLang="node"
>
<CodeExample lang="node">

```typescript
import { documents } from '@nitric/sdk';

await documents().collection('products').doc('nitric').delete();
```

</CodeExample>
<CodeExample lang="python">

```python
from nitric.api import Documents

documents = Documents()

await documents.collection("products").doc("nitric").delete()
```

</CodeExample>
<CodeExample lang="java">

```java
import io.nitric.api.kv.KeyValueClient;
...

var client = KeyValueClient.newBuilder(Product.class)
	.collection("products")
	.build();

client.delete("nitric");
```

</CodeExample>
<CodeExample lang="go">

```go
import (
	"github.com/nitrictech/go-sdk/api/documents"
)

...

docs, _ := documents.New()

// Create a reference to a new collection named 'products'
products := docs.Collection("products")

// Create a reference to a new document named 'nitric'
nitric := products.Doc("nitric")

err := nitric.Delete()

if err != nil {
	// handle error
}
```

</CodeExample>
<CodeExample lang="php">

```php
use Nitric\Api\Documents;

$docs = new Documents();

// Create a reference to a new collection named 'products'
$products = $docs->collection("products")

// Create a reference to a new document named 'nitric'
$docRef = $products->doc("nitric");

$docRef->delete();
```

</CodeExample>
<CodeExample lang="c-sharp">

```csharp
using Nitric.Api.KeyValue;
...

var client =  new KeyValueClient<Product>.NewBuilder()
	.Collection("products")
	.Build();

client.Delete("nitric");
```

</CodeExample>
</CodeExamples>

## Read data

There are three ways to retrieve data, any of these methods can be used with documents, collections of documents, or the results of queries:

- Call the `get()` method to retrieve a single document.

- Call the `fetch()` or `stream()` methods to retrieve multiple documents.

### Get data once

The following example shows how to retrieve the contents of a single document using `get()`:

<CodeExamples 
	languages={[
	{
		label: "Node.js",
		value: "node"
	},
	{
		label: "Python",
		value: "python"
	},
	{
		label: "Java",
		value: "java"
	},
	{
		label: "Go",
		value: "go"
	},
	{
		label: "PHP",
		value: "php"
	},
	{
		label: "C#",
		value: "c-sharp"
	}
	]}
	defaultLang="node"
>
<CodeExample lang="node">

```typescript
import { documents } from '@nitric/sdk';

const client = documents();

const product = await client.collection('products').doc('nitric').get();
```

</CodeExample>
<CodeExample lang="python">

```python
from nitric.api import Documents

documents = Documents()

product = await documents.collection("products").doc("nitric").get()

product.content["name"] = "new nitric"
```

</CodeExample>
<CodeExample lang="java">

```java
import io.nitric.api.kv.KeyValueClient;
...

var client = KeyValueClient.newBuilder(Product.class)
	.collection("products")
	.build();

var product = client.get("nitric");
```

</CodeExample>
<CodeExample lang="go">

```go
import (
    "github.com/nitrictech/go-sdk/api"
    "github.com/nitrictech/go-sdk/kvclient"
)

kvClient := client.KV()

product, err := kvclient.get("products", "nitric")

if err != nil {
	// Handle error
}
```

</CodeExample>
<CodeExample lang="php">

```php
use Nitric\Api\Documents;

$docs = new Documents();

$doc = $docs->collection("products")->doc("nitric")->get();
```

</CodeExample>
<CodeExample lang="c-sharp">

```csharp
using Nitric.Api.KeyValue;
...

var client =  new KeyValueClient<Product>.NewBuilder()
	.Collection("products")
	.Build();

var product = client.Get("nitric")
```

</CodeExample>
</CodeExamples>

### Queries

The documents API provides powerful query functionality for specifying which documents you want to retrieve from a collection.
Queries can be executed with the `fetch()` and `stream()` methods:

- The **fetch** method queries the document collection and fetches the results. The results include a documents list and a pagingToken, the later can be used for pagination.

- The **stream** method queries the document collection and streams the results one by one, this will reduce your memory consumption.

#### Simple queries

The following query returns all customers who are 21 years old or older:

<CodeExamples 
	languages={[
	{
		label: "Node.js",
		value: "node"
	},
	{
		label: "Python",
		value: "python"
	},
	{
		label: "Java",
		value: "java"
	},
	{
		label: "Go",
		value: "go"
	},
	{
		label: "PHP",
		value: "php"
	},
	{
		label: "C#",
		value: "c-sharp"
	}
	]}
	defaultLang="node"
>
<CodeExample lang="node">

```typescript
import { documents } from '@nitric/sdk';

const client = documents();

const query = await client
  .collection('customers')
  .query()
  .where('age', '>=', 21);

// Execute query
const results = await query.fetch();
```

</CodeExample>
<CodeExample lang="python">

```python
TODO
```

</CodeExample>

<CodeExample lang="java">

```java
TODO
```

</CodeExample>

<CodeExample lang="go">

```go
import (
	"github.com/nitrictech/go-sdk/api/documents"
)

...

docs, _ := documents.New()

// Create a reference to a new collection named 'products'
query := docs.Collection("customers").Query().Where(
	Condition("age").Gt("21")
)

// Create a reference to a new document named 'nitric'
result, err := query.Fetch()
```

</CodeExample>

<CodeExample lang="php">

```php
use Nitric\Api\Documents;

$docs = new Documents();

// Construct a query against the 'customers' collection
$query = $docs
    ->collection("customers")
    ->query()
    ->where("country", "==", "Australia");

// Retrieve a page of query results
$results = $query->fetch();
```

</CodeExample>

<CodeExample lang="c-sharp">

```csharp
TODO
```

</CodeExample>

</CodeExamples>

#### Compound queries

You can chain multiple equality operator methods to create specific queries.

<CodeExamples 
	languages={[
	{
		label: "Node.js",
		value: "node"
	},
	{
		label: "Python",
		value: "python"
	},
	{
		label: "Java",
		value: "java"
	},
	{
		label: "Go",
		value: "go"
	},
	{
		label: "PHP",
		value: "php"
	},
	{
		label: "C#",
		value: "c-sharp"
	}
	]}
	defaultLang="node"
>
<CodeExample lang="node">

```typescript
import { documents } from '@nitric/sdk';

const client = documents();

const query = await client
  .collection('customers')
  .query()
  .where('country', '==', 'Australia');
  .where('age', '>=', 21);

// Execute query
const documents = await query.fetch();
```

</CodeExample>
<CodeExample lang="python">

```python
TODO
```

</CodeExample>

<CodeExample lang="java">

```java
TODO
```

</CodeExample>

<CodeExample lang="go">

```go
import (
	"github.com/nitrictech/go-sdk/api/documents"
)

...

docs, _ := documents.New()

// Create a reference to a new collection named 'products'
query := docs.Collection("customers").Query().Where(
	Condition("country").Eq("Australia")
	Condition("age").Gt("21")
)

// Execute the query
result, err := query.Fetch()
```

</CodeExample>

<CodeExample lang="php">

```php
use Nitric\Api\Documents;

$docs = new Documents();

// Construct a query against the 'customers' collection
$query = $docs
    ->collection("customers")
    ->query()
    ->where("country", "==", "Australia")
    ->where("age", ">=", 21);

// Execute the query and retrieve a page of results
$results = $query->fetch();
```

</CodeExample>

<CodeExample lang="c-sharp">

```csharp
TODO
```

</CodeExample>

</CodeExamples>

### Query operators

To query documents, the `where()` method can be used. It takes three parameters: a field to filter on, a comparison operator, and a value.

The document service supports the following comparison operators:

- `<` less than

- `<=` less than or equal to

- `==` equal to

- `>` greater than

- `>=` greater than or equal to

- `!=` not equal to

- `startsWith` text value starts with

### Limit data

By default all documents that are returned by the query are retrieved. You can limit the number of documents retrieved using the `limit()` method:

<CodeExamples 
	languages={[
	{
		label: "Node.js",
		value: "node"
	},
	{
		label: "Python",
		value: "python"
	},
	{
		label: "Java",
		value: "java"
	},
	{
		label: "Go",
		value: "go"
	},
	{
		label: "PHP",
		value: "php"
	},
	{
		label: "C#",
		value: "c-sharp"
	}
	]}
	defaultLang="node"
>
<CodeExample lang="node">

```typescript
import { documents } from '@nitric/sdk';

const client = documents();

const query = client.collection('customers').query().limit(10);

// Get up to 10 customers
const results = await query.fetch();
```

</CodeExample>
<CodeExample lang="python">

```python
TODO
```

</CodeExample>

<CodeExample lang="java">

```java
TODO
```

</CodeExample>

<CodeExample lang="go">

```go
import (
	"github.com/nitrictech/go-sdk/api/documents"
)

...

docs, _ := documents.New()

// Create a reference to a new collection named 'products'
query := docs.Collection("customers").Query().Limit(10)

// Execute the query
result, err := query.Fetch()
```

</CodeExample>

<CodeExample lang="php">

```php
use Nitric\Api\Documents;

$docs = new Documents();

// Construct a query against the 'customers' collection
$query = $docs
    ->collection("customers")
    ->query()
    ->limit(10);

// Execute the query and retrieve up to 10 customers
$results = $query->fetch();
```

</CodeExample>

<CodeExample lang="c-sharp">

```csharp
TODO
```

</CodeExample>

</CodeExamples>

### Paginate data

You can split the data returned by a query into batches by combinding query `pagingToken` with the `limit()` method.

For example, use the `pagingFrom` token from a batch as the `pagingFrom` token for the next batch.

<CodeExamples 
	languages={[
	{
		label: "Node.js",
		value: "node"
	},
	{
		label: "Python",
		value: "python"
	},
	{
		label: "Java",
		value: "java"
	},
	{
		label: "Go",
		value: "go"
	},
	{
		label: "PHP",
		value: "php"
	},
	{
		label: "C#",
		value: "c-sharp"
	}
	]}
	defaultLang="node"
>
<CodeExample lang="node">

```typescript
import { documents } from '@nitric/sdk';

const client = documents();

// Get 25 customers query
const query = client.collection('customers').query().limit(25);

// First 25
const first = await query.fetch();

// Next 25
const next = await query.pagingFrom(first.pagingToken).fetch();
```

</CodeExample>
<CodeExample lang="python">

```python
TODO
```

</CodeExample>

<CodeExample lang="java">

```java
TODO
```

</CodeExample>

<CodeExample lang="go">

```go
TODO
```

</CodeExample>

<CodeExample lang="php">

```php
TODO
```

</CodeExample>

<CodeExample lang="c-sharp">

```csharp
TODO
```

</CodeExample>

</CodeExamples>

### Stream data

> Check back soon! We are working on it ‚ö†Ô∏è
