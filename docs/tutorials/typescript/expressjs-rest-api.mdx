# Building a REST API with Nitric

## What we'll do

1. Create a new project 
2. Create an Express.js function to handle API operations
3. Create a Key/Value collection to store data
4. Bind the Function to an Endpoint
5. Get it all running locally for testing
6. Deploy to your cloud of choice

| METHOD | ROUTE |
| --- | --- |
| GET: | /orders |
| GET: | /orders/{$orderId} |
| POST: | /orders |

## Getting started

This tutorial assumes you already have the Nitric CLI installed, if not you can follow the [install guide](https://nitric.io/docs/installation).

If you’d like to deploy the results to a cloud environment, you’ll also need to set up your credentials and any other details for the cloud(s) you choose AWS, GCP, Azure.

> TODO: Add links to cloud setup documentation pages

## New project

We’ll start by creating a new project for your REST API. During this process we'll also add our first serverless function.

```bash
nitric make:project my-rest-api
TODO: SELECT TEMPLATE
TODO: ENTER NAME "orders"
```

## Setup Express.js

First, let's just set up a "hello world" Express.js application in the new `orders` service and get that running locally.

When you open the project you just created it will have a structure similar to this:

```
my-rest-api/
|
+--nitric.yaml
+--orders/
   |
   +--node_modules/
   +--.gitignore
   +--index.ts
   +--package.json
   +--tsconfig.json
```

```typescript
// index.ts

import { express } from "express";

const PORT = "8080";
const app = express();

app.get('/', (_, res) => {
	res.send('Hello World');
});

app.listen(PORT, () => {
	console.log(`listening on port: ${PORT}`)
});
```

## Add a key/value collection

In order to store and retrieve orders through our API, we'll need to store their state somewhere. In this example, we'll use a Nitric Key/Value collection to persist our orders by their unique `orderId`. 

Adding a collection to our application is easy with Nitric, there's no IAM roles to create or identifiers/credentials to cram into environment variables. We just let Nitric know we want a collection and which services should be able to read/write to that collection. During deployment Nitric will take care of the rest, ensuring the services can connect to the datastore and have the appropriate roles/permissions for the access they need.

> Learn more: [Key/Value Store Documenation](https://nitric.io/docs/usage/keyvalue.md)

To add an "orders" collection, update the `nitric.yaml` file like so:

```YAML
name: my-rest-api

services:
	orders:
		path: orders
		runtime: function/nodets12
		# TODO: Add read/write access

# TODO: check this is correct
collections:
	order: {}
```

## Working with orders

Now that we have a key/value store set up, and a serverless function to handle incoming requests, let's implement a few API endpoints and start storing and retrieving order objects.

