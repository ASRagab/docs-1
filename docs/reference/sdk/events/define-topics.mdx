Topics are a resource defined in a stack file, such as `nitric.yaml`. At the root level of the stack file, add a `topics` key, which contains an array of topics. Topics will be automatically created and configured with defaults by the Nitric CLI when deploying to a cloud environment and emulated when running and testing locally.

```yaml
topics:
	# A Topic with default options
	my-topic: {}
```

During our preview release, no additional configuration is needed or available to create topics. All services and functions in your Nitric project will be configured with appropriate permissions to enable them to publish to all available topics. Future configuration will be introduced to define the list of permitted publishers (enabling least-privilege security by default), as well as configure more advanced topic features.

> Have a property or customization option that you need? Let us know on [GitHub](https://github.com/nitrictech/cli)

## Subscribing to Events

Resources that can subscribe to a topic, such as [services](./services) and [functions](./services-functions) provide a `triggers` property defining their triggers. Adding a new `topics` object under `triggers`, followed by the name of the topic(s) to subscribe to will set up a subscription between the resource and the topic(s). In the case of services, this causes the service to be invoked each time a new event is published to the topic, with the event being provided as the trigger payload. This is useful mechanism to use when one service needs to communicate with another in order to have the second service perform some work.

```yaml
services:
	my-subscribed-function:
		path: mysubscribedfunction
		runtime: function/python37
		triggers:
			topics:
				- my-first-topic
```

### At-Least-Once Delivery

Nitric events are delivered using cloud services that provide 'at least once delivery'. This means that typically every event is delivered at least once to each subscriber in the order it was received. However, the message ordering isn't guaranteed and messages may occasionally be delivered more than once.

To avoid reprocessing events that are delivered more than once your subscribers should typically be implemented using idempotent design patterns. Every Nitric event provides a unique `ID`, which is useful when implementing these patterns. Persisting the event id, alongside the results of processing the event, allows your application to check whether the id is already present before reprocessing duplicates.

> Event IDs are automatically generated by the [Nitric Membrane](./nitric-membrane) as v4 UUIDs. However, an ID can be provided when [publishing events](#event-ids) via the SDK if a custom implementation is needed.
